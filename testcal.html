// testcal.html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Google Calendar Events</title>
    <script src="https://www.google.com/jsapi?key=AIzaSyA8ibG6fO1SGlZilUaFrtQ-oFg0fQF2ksg"></script>
</head>
<body>
    <script>
        google.load("gdata", "2.x");

        function init() {
            google.gdata.client.init(handleGDError);
            loadMyCalendar();
        }

        function loadMyCalendar() {
            loadCalendarByAddress('experimentalsoundingfinland@gmail.com'); // Replace with your calendar address
        }

        function loadCalendarByAddress(calendarAddress) {
            var calendarUrl = 'https://www.google.com/calendar/feeds/' + calendarAddress + '/public/full';
            loadCalendar(calendarUrl);
        }

        function loadCalendar(calendarUrl) {
            var service = new google.gdata.calendar.CalendarService('gdata-js-client-samples-simple');
            var query = new google.gdata.calendar.CalendarEventQuery(calendarUrl);
            query.setOrderBy('starttime');
            query.setSortOrder('ascending');
            query.setFutureEvents(true);
            query.setSingleEvents(true);
            query.setMaxResults(100);

            service.getEventsFeed(query, listEvents, handleGDError);
        }

        function listEvents(feedRoot) {
            // Process the events and create your Markdown content
            // You can format the events as needed and write them to a Markdown file.
            // For example, create a list of events with their titles, dates, and descriptions.
        }

        function handleGDError(e) {
            console.error('Error:', e);
        }

        init();
    </script>
</body>
</html>
